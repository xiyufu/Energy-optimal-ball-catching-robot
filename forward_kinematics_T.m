function [T_out] = fkine(q)

T_out = zeros(16, 1);

x0 = cos(q(3));
x1 = cos(q(1));
x2 = cos(q(2));
x3 = x1*x2;
x4 = sin(q(3));
x5 = -x4;
x6 = sin(q(2));
x7 = x1*x6;
x8 = x0*x3 + x5*x7;
x9 = sin(q(5));
x10 = x0*x7;
x11 = x3*x4;
x12 = x10 + x11;
x13 = cos(q(4));
x14 = sin(q(1));
x15 = x14;
x16 = sin(q(4));
x17 = x12*x13 + x15*x16;
x18 = cos(q(5));
x19 = x17*x18 + x8*x9;
x20 = -cos(q(6));
x21 = sin(q(6));
x22 = -x21;
x23 = -x13;
x24 = -x12*x16 - x15*x23;
x25 = -x9;
x26 = x17*x25 + x18*x8;
x27 = x14*x2;
x28 = x14*x6;
x29 = x0*x27 + x28*x5;
x30 = x0*x28;
x31 = x27*x4;
x32 = x30 + x31;
x33 = -x1;
x34 = x13*x32 + x16*x33;
x35 = x18*x34 + x29*x9;
x36 = -x16*x32 - x23*x33;
x37 = x18*x29 + x25*x34;
x38 = -x6;
x39 = x0*x38 + x2*x5;
x40 = x38*x4;
x41 = x0*x2;
x42 = x40 + x41;
x43 = x13*x42;
x44 = x18*x43 + x39*x9;
x45 = -x16*x42;
x46 = x18*x39 + x25*x43;

T_out(1) = x19*x20 + x22*x24;
T_out(2) = x19*x21 + x20*x24;
T_out(3) = x26;
T_out(4) = 0.07*x10 + 0.07*x11 + 0.21*x26 + 0.27*x7 + 0.302*x8;
T_out(5) = x20*x35 + x22*x36;
T_out(6) = x20*x36 + x21*x35;
T_out(7) = x37;
T_out(8) = 0.27*x28 + 0.302*x29 + 0.07*x30 + 0.07*x31 + 0.21*x37;
T_out(9) = x20*x44 + x22*x45;
T_out(10) = x20*x45 + x21*x44;
T_out(11) = x46;
T_out(12) = 0.27*x2 + 0.302*x39 + 0.07*x40 + 0.07*x41 + 0.21*x46 + 0.29;
T_out(13) = 0;
T_out(14) = 0;
T_out(15) = 0;
T_out(16) = 1;
